\subsection{Gauss-elimination}
\label{gauss}
% 1.4
% Sætning 1.4 kan vi bevise den
En algoritme til løsning af lineære ligningssystemer er  \textit{rækkereduktionsalgoritmen}, som reducerer en totalmatrix til reduceret trappeform.
Når den bruges til at løse lineære ligningssystemer, kaldes denne proces for \textit{Gauss-elimination}.
I algoritmen bruges de elementære rækkeoperationer til at omdanne en matrix $A$ til trappeform. 
Herefter benyttes rækkeoperationerne til at reducere matricen til reduceret trappeform.
Algoritmen gennemgår således følgende skridt:
%
\begin{enumerate}
\item Find første ikke-nulsøjle i $A$ fra venstre.
\item Ved rækkeombytning placeres en ikke-nulindgang øverst i pivotsøjlen.
\item Skab nuller under pivotindgangen ved hjælp af rækkeudskiftning.
\item Øverste række markeres som afsluttet og trin $1-4$ gennemføres nu på den næste række. Indtil alle rækker er markeret som afsluttet.
\item Alle rækker med pivotindgange skaleres, så alle pivotindgange er lig $1$.
\item Ved rækkeudskiftning sikres nu $0$'er over og under pivotindgangene.
\end{enumerate}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Eksempel
\begin{eks}
Betragt ligningssystemet 
%
\begin{align*}
\begin{array}{rlr}
x_1-x_3-2x_4-8x_5    &=  &-3 \\
-2x_1+x_3+2x_4+9x_5  &=  &5 \\
3x_1-2x_3-3x_4-15x_5 &=  &-9 
\end{array}
\end{align*}
%
Ligningssystemet opskrevet som totalmatrix $[A \text{   }|\text{ }\mathbf{b}]$ er
%
\begin{equation*}
A=
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
1 & 0 & -1 & -2 & -8 & -3 \\
-2 & 0 & 1 & 2 & 9 & 5 \\
3 & 0 & -2 & -3 & -15 & -9 \\
\end{block}
\end{blockarray}
\end{equation*}
%
De elementære rækkeoperationer benyttes nu med henblik på at reducere totalmatricen til trappeform.
%
\begin{equation*}
\xrightarrow[R_3 \rightarrow R_3-3R_1]{R_2 \rightarrow R_2+2R_1} 
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  1 & 0 & -1 & -2 & -8 & -3 \\
  0 & 0 & -1 & -2 & -7 & -1 \\
  0 & 0 & 1 & 3 & 9 & 0 \\
\end{block}
\end{blockarray}
\end{equation*}
%
\begin{equation*}
\xrightarrow{R_3 \rightarrow R_3+R_2}
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  \hlight{1} & 0 & -1 & -2 & -8 & -3 \\
  0 & 0 & \hlight{-1} & -2 & -7 & -1 \\
  0 & 0 & 0 & \hlight{1} & 2 & -1 \\
\end{block}
\end{blockarray}
\end{equation*}
%
Det fortsættes nu med henblik på at opnå totalmatricen fra trappeform til reduceret trappeform.
%
\begin{equation*}
\xrightarrow[R_2 \rightarrow R_2+2R_3]{R_1 \rightarrow R_1+2R_3}
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  1 & 0 & -1 & 0 & -4 & -5 \\
  0 & 0 & -1 & 0 & -3 & -3 \\
  0 & 0 & 0 & 1 & 2 & -1 \\
\end{block}
\end{blockarray}
\end{equation*}
%
\begin{equation*}
\xrightarrow{R_2 \rightarrow -1R_2}
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  1 & 0 & -1 & 0 & -4 & -5 \\
  0 & 0 & 1 & 0 & 3 & 3 \\
  0 & 0 & 0 & 1 & 2 & -1 \\
\end{block}
\end{blockarray}
\end{equation*}
%
\begin{equation*}
\xrightarrow{R_1 \rightarrow R_1+R_2}
\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  \hlight{1} & 0 & 0 & 0 & -1 & -2 \\
  0 & 0 & \hlight{1} & 0 & 3 & 3 \\
  0 & 0 & 0 & \hlight{1} & 2 & -1 \\
\end{block}
\end{blockarray}
\end{equation*}
%
Herefter kan følgende løsninger opskrives:
%
\begin{align*}
\begin{array}{rrcll}
x_1-x_5     =&-2   &\iff &x_1   =&x_5-2 \\
x_3-3x_5    =&3    &\iff &x_3   =&-3x_5+3 \\
x_4+2x_5    =&-1   &\iff &x_4   =&-2x_5-1 
\end{array}
\end{align*}
%
Parameterfremstillingen for løsningen i $\R^5$ er dermed
%
  \begin{align*}
    \mathbf{x} &= \begin{bmatrix}
           x_{1} \\
           x_{2} \\
           x_{3} \\
           x_{4} \\
           x_{5} \\
         \end{bmatrix} 
         = \begin{bmatrix}
           -2 \\
           0 \\
           3 \\
           -1 \\
           0 \\
         \end{bmatrix}
         +x_2 \begin{bmatrix}
           0 \\
           1 \\
           0 \\
           0 \\
           0 \\
         \end{bmatrix}
         +x_5 \begin{bmatrix}
           1 \\
           0 \\
           -3 \\
           -2 \\
           1 \\
         \end{bmatrix}
  \end{align*} 
%
\label{eks_gauss}
%
% Frie variable
%
\end{eks}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           %%
%%    Rang og nullitet       %%
%%                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\subsection{Rang og nullitet}
% 
For at beskrive en matrices egenskaber i forhold til pivotindgange er der brug for at definere nogle begreber. 
%
\begin{defn}{}{rangnull}
\textbf{Rangen} af en matrix $A$ er antallet af pivotindgange, hvilket noteres $\text{rang}(A)$. \\
\textbf{Nulliteten} af $A$ er antallet af søjler uden pivotindgang, hvilket noteres $\text{null}(A)$.
\end{defn}
%
\noindent
Bemærk, at der for en $m \times n$ matrix gælder, at $\text{rang}(A)+\text{null}(A)=n$. 
% . 
%
Med udgangspunkt i matrix $A$ på reduceret trappeform fra \ref{eks_gauss} bliver rang og nullitet i 
%
\begin{align*}
A=\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  \hlight{1} & 0 & 0 & 0 & -1 & -2 \\
  0 & 0 & \hlight{1} & 0 & 3 & 3 \\
  0 & 0 & 0 & \hlight{1} & 2 & -1 \\
\end{block}
\end{blockarray},
\end{align*}
således $\text{rang}(A)=3$ og $\text{null}(A)=3$. 
%
% Hvilket er heldigt når der er 6 søjler
%
\begin{thm}{Konsistens}{konsistens}
%
Følgende udsagn er ækvivalente:
%
\begin{enumerate}[label=(\alph*)]
\item Matricen $A\mathbf{x}=\mathbf{b}$ er konsistent.
\item Vektoren $\mathbf{b}$ er en linearkombination af søjlerne i $A$.
\item Den reducerede trappeform af totalmatricen $[A \text{   }| \text{ }\mathbf{b}]$ har ingen rækker på formen $[ 0 \ldots 0 \text{  }| \text{ } d  ]$, hvor $d \neq 0$.
\end{enumerate}
%
\end{thm}
%
\begin{proof}
%
Lad $A$ være en $n \times m$ matrix og $\mathbf{b} \in \R^m$. Jævnfør \ref{defn:mvp} følger det, at der eksisterer en vektor 
%
\begin{align*}    
       \mathbf{v} = \begin{bmatrix}
		v_{1} \\
        v_{2} \\
        \vdots \\
        v_{n} 
        \end{bmatrix},  
\end{align*}
%
i $\R^n$, der opfylder, at $A\mathbf{v}=\mathbf{b}$, hvis og kun hvis $$v_1 \mathbf{a}_1+v_2 \mathbf{a}_2 + \ldots + v_n \mathbf{a}_n \text{, }$$ hvilket er linearkombinationen af matricen og vektoren. 
Det følger derfor, at (a) og (b) er ækvivalente.
Herefter bevises, at (a) og (c) er ækvivalente. 
Hvis (c) er falsk, følger det, at  $$0 x_1+0 x_2 + \ldots + 0x_n =d,$$ hvor $d\neq0$. Da dette ikke har nogen løsning, følger det, at ligningssystemet således bliver inkonsistent. 
Såfremt (c) er sandt, gælder der omvendt, at alle rækker i den reducerede trappeform indeholder en løsning, som også er løsning til $A\mathbf{x}=\mathbf{b}$. 
Således er (a) og (c) ækvivalente.
%
\end{proof}
\\
%
Med udgangspunkt i \ref{eks_gauss} ses derfor, at $A$ er konsistent, da $d$ ikke er en pivotindgang. Såfremt ligningssystemet skulle være inkonsistent, kunne den have formen
%
\begin{align*}
B=\begin{blockarray}{ccccccc}
x_1 & x_2 & x_3 & x_4 & x_5 & b \\
\begin{block}{[ccccc|c]c}
  \hlight{1} & 0 & 0 & 0 & -1 & -2 \\
  0 & 0 & \hlight{1} & 0 & 3 & 3 \\
  0 & 0 & 0 & 0 & 0 & \hlight{-1} \\
\end{block}
\end{blockarray},
\end{align*}
%
hvor $d \neq 0$ er i indgang $b_{3,6}$. 
Det følger derfor også, at der ikke kan opnås dette $b$, da det ikke kan laves som linearkombination af søjlerne. 
%