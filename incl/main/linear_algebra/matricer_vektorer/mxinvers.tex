\section{Elementære og inverse matricer}
At multiplicere en matrix $A$ med en $n \times n$ \textit{elementær matrix} $E$ svarer til at udføre én rækkeoperation på $A$. 
Dermed kan enhver rækkeoperation udføres gennem matrixmultiplikation. 
En $n \times n$ matrix $E$ er elementær, hvis én rækkeoperation udført på $I_n$ resulterer i $E$. 
%Eksempel? 
\\\\
Lad nu $A$ være en $m \times n$ matrix og $E$ en elementær $m \times m$ matrix, der er resultatet af én rækkeoperation udført på $I_m$. 
Matrixproduktet $EA$ kan opnås ved at udføre én rækkeoperation på $A$. 
Enhver elementær matrix er desuden \textit{invertibel}, og dens \textit{invers} er også en elementær matrix. 
%
\begin{defn}{}{mxinvers}
En $n \times n$ matrix $A$ er \textbf{invertibel}, hvis en $n \times n$ matrix $B$ eksisterer, så $AB=BA=I_n$. 
\end{defn}
\noindent
%
Det er endvidere relevant, hvorvidt inversen er entydig.
\begin{thm}{}{mxinversent}
Såfremt en matrix $A$ er invertibel, findes der en entydig matrix $B$, som er dennes invers.
\end{thm}
%
\begin{proof}
Antag at der findes to matricer  $B$ og $C$, som begge har størelsen $n \times n$, hvorom det gælder, at disse er inverse til $n \times n$ matricen $A$.
Det gælder derfor fra \ref{defn:mxinvers}, at $A$ er inversen til $B$ og $C$.
Derfor haves at $AB=BA=I_{n}$, samt at $AC=CA=I_{n}$. 
Fra \ref{thm:mxmulti} haves derfor at:
\begin{align*}
B=BI_n&=B(AC) \\
&=(BA)C \\
&=I_nC=C
\end{align*} 
Altså er $B=C$ og $A$'s invers er derfor entydig, denne kaldes $A^{-1}$.
\end{proof} \\
%
Såfremt $A$ er en invertibel $n \times n$ matrix, gælder det for ethvert $\mathbf{b} \in \R^n$, at $A\textbf{x}=\mathbf{b}$ har den entydige løsning $A^{-1}\mathbf{b}$.
Inverse matricer har en række egenskaber, hvoraf nogle centrale er formuleret i \ref{thm:mxinvers}. 
%
\begin{thm}{}{mxinvers}
Givet to $m \times n$ matricer $A$ og $B$, så gælder, at
\begin{enumerate}[label=(\alph*)]
\item Hvis $A$ er invertibel, så er $A^{-1}$ invertibel, og $(A^{-1})^{-1}=A$.
\item Hvis $A$ og $B$ er invertible, så er $AB$ invertibel, og $(AB)^{-1}=A^{-1}B^{-1}$.
\item Hvis $A$ er invertibel, så er $A^T$ invertibel, og $(A^T)^{-1}=(A^{-1})^T$.
\end{enumerate}
\end{thm}
%
%
\begin{proof}
\begin{enumerate}[label=(\alph*)]
\item Udsagnet følger af \ref{defn:mxinvers}. 
%
\item Antag, at $A$ og $B$ er invertibel matricer, så $(AB)(B^{-1}A^{-1})=A(BB^{-1})A^{-1}=AI_nA^{-1}=AA^{-1}=I_n$. 
Det kan gennem lignende operationer vises at $(B^{-1}A^{-1})(AB)=I_n$.
Dermed er $AB$ en invertibel matrix, hvis invers er $A^{-1}B^{-1}$.
Dermed er $AB^{-1}=A^{-1}B^{-1}$.
%
\item Antag at A er invertibel. 
Det følger fra \ref{defn:mxinvers}, at $A^{-1}A=I_n$. 
Jævnfør \ref{thm:mxmulti}(g) følger det hermed, at $A^T(A^{-1})^T=(A^{-1}A)^T=I_n^T=I_n$. 
Ligeledes kan det vises, at $(A^{-1})^TA^T=I_n$. 
Derfor er $A^T$ en invertibel matrix med inversen $(A{-1})^T$ og $(A^T)^{-1}A=(A^{-1})^T$.
\end{enumerate}
\end{proof}\\
%
%NOGET OM ELEMENTÆRE MATRICER OG INVERTIBILITET
%
Enhver rækkeoperation kan udføres ved hjælp af matrixmultiplikation.
\begin{thm}{}{eleinv}
Lad $A$ være en $m \times n$ matrix, og $R$ den reducerede trappeform af $A$. 
Så eksisterer der en invertibel $m \times m$ matrix $P=E_kE_{k-1} \cdots E_1$, så $PA=R$.
\end{thm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% HER
\begin{proof}
%Lad $A$ være en $m \times n$ matrix og $P=E_kE_{k-1} \cdots E_1$ være en $m \times m$ matrix. 
%$P$ er dermed et produkt af elementære matricer, hvormed $P$ er invertibel. 
%Jævnfør definition \ref{defn:mxmulti} haves, at 
%$$
%PA=
%\begin{bmatrix}
%P\textbf{a}_1 & P\textbf{a}_2 & \ldots P\textbf{a}_m
%\end{bmatrix}. 
%$$
%Antag, at række $5$ i $A$ skal multipliceres med en skalar $c$. 
%Lad $p_{5,5}=c$, og resten af indgangene i $\textbf{p}_5$ være $0$. 
%Dermed haves, at række $5$ i $PA$ er 
%$$
%\begin{bmatrix}
%c
%\end{bmatrix}
%$$
Lad $A$ være en $m \times n$ matrix og $P$ være et $m \times m$ produkt af de elementære matricer som skal til for at omdanne en matrix til reduceret rækkeform, $E_kE_{k-1} \cdots E_1$. 
$P$ er dermed invertibel da enhver elemenetær matrix er invertibel og produktet af to invertible matricer også er invertibel. 
Det vides at gauss elimination omdanner en matrix til reduceret trappeform, ved hjælp af elementære rækkeoperationer, så for hver af de operationer, findes der en tilsvarende elementær matrice.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% hjælp
\end{proof}
%
\\
\ref{thm:eleinv} medfører desuden \ref{kor:eleinv}.
%måske noget mere her (at det er vigtigt for rækkeoperationer?).  
\begin{kor}{}{eleinv}
Matrixligningerne $A\textbf{x}=\textbf{b}$ og $R\textbf{x}=\textbf{c}$ har samme løsninger, hvor 
$[R \text{   }| \textbf{c}]$
er den reducerede trappeform af den udvidede matrix 
$[A \text{   }| \textbf{b}].
$
\end{kor}\noindent
%
%\begin{proof}
%Lad $P$ være en invertibel matrix, så 
%$P[A \text{   }| \textbf{b}]
%=
%[R \text{   }| \textbf{c}]
%$.
%Så gælder det, at 
%$$
%P
%\begin{bmatrix}
%A & \textbf{b}
%\end{bmatrix}
%=
%\begin{bmatrix}
%PA & P\textbf{b}
%\end{bmatrix}
%=
%\begin{bmatrix}
%R & \textbf{c}
%\end{bmatrix}
%\text{, }
%$$
%hvormed $PA=R$ og $P\textbf{b}=\textbf{c}$.
%Heraf følger, at $A=P^{-1}R$ og $\textbf{b}=P^{-1}\textbf{c}$, da $P$ er invertibel. 
%\\\\
%Antag, at $\textbf{v}$ er en løsning til $A\textbf{x}=\textbf{b}$. Så er
%$$
%R\textbf{v}=(PA)\textbf{v}=P(A\textbf{v})=P\textbf{b}=\textbf{c},
%$$
%hvormed $\textbf{v}$ er en løsning til $R\textbf{x}=\textbf{c}$. 
%Antag nu i stedet, at $\textbf{v}$ er en løsning til $R\textbf{x}=\textbf{c}$. Så er
%$$
%A\textbf{v}=(P^{-1}R)\textbf{v}=P^{-1}(R\textbf{v})=P^{-1}\textbf{c}=\textbf{b},
%$$
%hvormed $\textbf{v}$ er en løsning til $A\textbf{x}=b$. 
%Dermed er det bevist, at $A\textbf{x}=b$ og $R\textbf{x}=c$ har samme løsning.
%%Beviset for korollar \ref{kor:eleinv} følger af beviset for sætning \ref{thm:eleinv} med tilføjelsen, at hvis $\textbf{b}=\textbf{0}$, så er $\textbf{c}=\textbf{0}$, hvilket resulterer i nulvektoren i begge udtryk.
%\end{proof}
%\\
%
%
%HER SAD DEF 3.8 FØR
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Det er dog ikke altid, der findes en matrix $B$, så kriterierne i \ref{defn:mxinvers} opfyldes. 
%
\begin{thm}{}{mxinvertibel}
Lad $A$ være en $n \times n$ matrix. 
$A$ er invertibel, hvis og kun hvis den reducerede trappeform af $A$ er $I_n$.
\end{thm}
%
\begin{proof}
Antag, at $n\times n$ matricen $A$ er invertibel, og at der findes en vektor \textbf{u} i $\R^n$, så $A\textbf{v}=\textbf{0}$. 
Da $A$ er en invertibel matrix, gælder det for ethvert $\mathbf{b} \in \R^n$, at $A\textbf{x}=\mathbf{b}$ har løsningen $A^{-1}\mathbf{b}$ og derfor er $\textbf{v}=A^{-1}\textbf{0}=\textbf{0}$. 
Den eneste løsning til problemet er derfor $\textbf{0}$. 
Såfremt $A$ er invertibel, følger det derfor fra \ref{thm:mxlinuaf}, at $\text{ rang}(A)=n$.
Det følger derfor, at $A$ på reduceret trappeform er $I_n$.
\\\\
Antag nu, at den reducerede trappeform af $A$=$I_n$. 
Jævnfør \ref{thm:mxinvertibel} eksister der en invertibel $n \times n$ matrix $P$, hvorom det gælder, at $PA=I_n$. 
%
\begin{align*}
A=I_nA=(P^{-1}P)A=P^{-1}(PA)=P^{-1}.
\end{align*}
%
Fra \ref{thm:mxinvers} fremgår det, at $P^{-1}$ er en invertibel matrix, og det er hermed bevist, at $A$ er invertibel, da $A=P^{-1}$.
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%find begin example
\\
Det er fordelagtigt at benytte algoritmer til at invertere matricer.
Jævnfør \ref{defn:mxinvers} opfylder en $n \times n$ matrices inverse matrix $AA^{-1}=I_n$.
Med dette kan ligningen $A[\textbf{x}_1\text{  }\textbf{x}_2\text{  }\ldots\text{  }\textbf{x}_n ] = [\textbf{e}_1\text{  }\textbf{e}_2\text{  }\ldots\text{  }\textbf{e}_n ]$ opstilles.
Da den inverse matrix er entydig kan søjlerne findes ved at løse $A\textbf{x}_i = \textbf{e}_i$.
Det gøres ved Gauss-elimination på $[A\textbf{ }|\textbf{ }\textbf{e}_i]$.
Kombinationen af rækkeoperationer for at få $A$ på reduceret trappeform er kun afhængig af $A$.
Dette betyder, at hver ligning løses med samme rækkeoperationer og alle søjler kan findes samtidigt.
Dette gøres med Gauss-elimination på $[A\textbf{ }|\textbf{ }I_n]$, hvor resultatet bliver $[I_n\textbf{ }|\textbf{ }A^{-1}]$, hvis $A$ er invertibel.\\
%
%Lad $A$ være en $n \times n$ matrix. 
%Givet et input $[A \text{   } I_n]$ skal algoritmen udføre elementære rækkeoperationer på $A$, således algoritmens output bliver $[R \text{   } B]$, hvor $R$ er $A$ på reduceret trappeform. 
%Hvis $R=I_n$, er $A$ invertibel og $B=A^{-1}$.
%Hvis $R \neq I_n$, er $A$ ikke invertibel.\\
%
\begin{eks}
\label{eks:fisk5}
Lad
\begin{align*}
A=\begin{blockarray}{ccc}
\begin{block}{[ccc]}
1 & 1 & 1  \\
1 & 2 & 2  \\
1 & 3 & 2  \\
\end{block}
\end{blockarray}.
\end{align*}
%
For at finde dennes invers $A^{-1}$ opstilles totalmatricen 
\begin{align*}
[A \text{   } | \text{ } I_3] =\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 1 & 1 & 0 & 0 \\
1 & 2 & 2 & 0 & 1 & 0 \\
1 & 3 & 2 & 0 & 0 & 1 \\
\end{block}
\end{blockarray}.
\end{align*}
Ved at udføre rækkeoperationer omdannes $A$ til reduceret trappeform.
\begin{align*}
[A \mid I_3] = &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 1 & 1 & 0 & 0 \\
1 & 2 & 2 & 0 & 1 & 0 \\
1 & 3 & 2 & 0 & 0 & 1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow{R_2 \rightarrow R_2-R_1} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 1 & 1 & 0 & 0 \\
0 & 1 & 1 & -1 & 1 & 0 \\
1 & 3 & 2 & 0 & 0 & 1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow{R_3 \rightarrow R_3-R_1} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 1 & 1 & 0 & 0 \\
0 & 1 & 1 & -1 & 1 & 0 \\
0 & 2 & 1 & -1 & 0 & 1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow{R_3 \rightarrow R_3-2R_2} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
\hlight{1} & 1 & 1 & 1 & 0 & 0 \\
0 & \hlight{1} & 1 & -1 & 1 & 0 \\
0 & 0 & \hlight{-1} & 1 & -2 & 1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow{R_3 \rightarrow -1R_3} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 1 & 1 & 0 & 0 \\
0 & 1 & 1 & -1 & 1 & 0 \\
0 & 0 & 1 & -1 & 2 & -1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow[R_1 \rightarrow R_1-R_3]{R_2 \rightarrow R_2-R_3} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
1 & 1 & 0 & 2 & -2 & 1 \\
0 & 1 & 0 & 0 & -1 & 1 \\
0 & 0 & 1 & -1 & 2 & -1 \\
\end{block}
\end{blockarray}	\\
\xrightarrow{R_1 \rightarrow R_1-R_2} &
\begin{blockarray}{cccccc}
\begin{block}{[ccc|ccc]}
\hlight{1} & 0 & 0 & 2 & -1 & 0 \\
0 & \hlight{1} & 0 & 0 & -1 & 1 \\
0 & 0 & \hlight{1} & -1 & 2 & -1 \\
\end{block}
\end{blockarray}.
\end{align*}
Det fremgår derfor, at $A$ er invertibel, da dens reducerede trappeform er $I_3$. $B$-siden, hvor $I_3$ før var, er nu
\begin{align*}
B=A^{-1}=\begin{blockarray}{ccc}
\begin{block}{[ccc]}
2 & -1 & 0 \\
0 & -1 & 1 \\
-1 & 2 & -1 \\
\end{block}
\end{blockarray}.
\end{align*}
%
\end{eks}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ref{thm:mxinvers2} beskriver nogle yderligere egenskaber for invertible matricer. 
%
\begin{thm}{}{mxinvers2}
%Givet to $m \times n$ matricer $A$ og $B$, så gælder, at (det er bare leftover aye?)
Lad $A$ være en $n \times n$ matrix. 
Da er følgende udsagn ækvivalente.
\begin{enumerate}[label=(\alph*)]
\item $A$ er invertibel.
\item Den reducerede trappeform af $A$ er $I_n$.
\item $\text{rang}(A)=n$.
\item Spannet af søjlerne i $A$ er $R^n$.
\item Ligningssystemet $A\textbf{x}=\textbf{b}$ er konsistent for alle $\textbf{b}$ i $R^n$.
\item $\text{null}(A)=0$.
\item Søjlerne i $A$ er lineært uafhængige.
\item Den eneste løsning for $A\textbf{x}=\textbf{0}$ er $\textbf{0}$.
\item Der eksisterer en $n \times n$ matrix $B$, så $BA=I_n$.
\item Der eksister en $n \times n$ matrix $C$, så $AC=I_n$.
\item $A$ er et produkt af elementære matricer.
%hvis vi tager det sidste punkt med er vi også nødt til at redegøre for det. 
\end{enumerate}
\end{thm}
\begin{proof}
Lad $A$ være en $n \times n$ matrix.
Jævnfør \ref{thm:mxinvertibel} er (a) og (b) ækvivalente. 
Da $A$ er kvadratisk, er (b) ligeledes ækvivalent med (c), (d) og (e) jævnfør \ref{thm:spaneqv}. 
Jævnfør \ref{thm:mxlinuaf} er (b) desuden ækvivalent med (f), (g) og (h). 
Eftersom (a) er ækvivalent med (b), er (a) også ækvivalent med (c), (d), (e), (f), (g) og (h). 
\\\\
At (a) og (k) er ækvivalente, bevises i to skridt. 
Bemærk først, at hvis $A$ er invertibel, så er $I_n$ den reducerede trappeform af $A$. 
Jævnfør \ref{thm:eleinv} og \ref{thm:mxinvertibel} eksisterer der en invertibel matrix $P$, så at $PA=I_n$, hvormed $A=P^{-1}$. 
Da $P=E_kE_{k-1} \cdots E_1$, så er $P^{-1}=E_1^{-1} \cdots E_{k-1}^{-1}E_k^{-1}$.
$A$ er dermed et produkt af elementære matricer, hvilket beviser, at (a) medfører (k). \\\\
Antag nu, at $A$ er et produkt af elementære matricer. 
Elementære matricer er invertible, hvormed $A$ er et produkt af invertible matricer. 
$A$ er derfor invertibel, hvilket bekræfter (a), hvilket gør (a) og (k) ækvivalente. 
\\\\
At (a) medfører (i) er åbenlyst, da $B=A^{1}$. 
Antag nu, at der eksisterer en $n \times n$ matrix $B$, så $BA=I_n$. Lad $\textbf{v} \in \R^n$, så at $A\textbf{v}=\textbf{b}$. Så gælder det, at 
$$
\textbf{v} = I_n\textbf{v} = (BA)\textbf{v} = B(A\textbf{v}) = B\textbf{0} = \textbf{0}.
$$
Bemærk, at (i) dermed medfører (h).
Eftersom (h) er ækvivalent med (a), medfører (i) derfor også (a).
Således er (i) og (a) ækvivalente. 
\\\\
At (a) medfører (j) er åbenlyst, da $C=A^{1}$.
Antag nu, at der eksister en $n \times n$ matrix $C$, så $AC=I_n$. 
Lad $\textbf{b} \in \R^n$ og $\textbf{v}=C\textbf{b}$. 
Så gælder, at 
$$
A\textbf{v} = A(C\textbf{b}) = (AC)\textbf{b} = I_n\textbf{b} = \textbf{b}.
$$
Bemærk, at (j) dermed medfører (e).
Eftersom (e) er ækvivalent med (a), medfører (j) derfor også (a).
Således er (j) og (a) ækvivalente, og alle punkter i \ref{thm:mxinvers2} er dermed ækvivalente.
\end{proof}